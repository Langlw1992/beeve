---
title: Form
description: åŸºäº @tanstack/solid-form çš„è¡¨å•ç»„ä»¶ç³»ç»Ÿï¼Œæä¾›å®Œæ•´çš„è¡¨å•çŠ¶æ€ç®¡ç†å’ŒéªŒè¯åŠŸèƒ½ã€‚
---

import { Tabs, TabItem } from '@astrojs/starlight/components'

## æ¦‚è¿°

Form ç»„ä»¶ç³»ç»ŸåŸºäº [@tanstack/solid-form](https://tanstack.com/form/latest) æ„å»ºï¼Œæä¾›äº†ä¸€å¥—å®Œæ•´çš„è¡¨å•è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

- ğŸ¯ **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript æ”¯æŒ
- âœ… **çµæ´»éªŒè¯** - æ”¯æŒåŒæ­¥/å¼‚æ­¥éªŒè¯ï¼Œé›†æˆ Zod ç­‰ Schema åº“
- ğŸ¨ **æ— éšœç¢** - éµå¾ª ARIA è§„èŒƒï¼Œè‡ªåŠ¨å…³è” labelã€inputã€error
- ğŸ“¦ **ç»„åˆå¼ API** - ç»†ç²’åº¦çš„ç»„ä»¶æ‹†åˆ†ï¼Œçµæ´»ç»„åˆ
- âš¡ **é«˜æ€§èƒ½** - åŸºäº SolidJS çš„ç»†ç²’åº¦å“åº”å¼æ›´æ–°

## å®‰è£…

```bash
pnpm add @beeve/ui @tanstack/solid-form zod
```

## åŸºç¡€ç”¨æ³•

<Tabs>
<TabItem label="é¢„è§ˆ">

```tsx
import { createForm } from '@tanstack/solid-form'
import {
  Form,
  FormField,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
} from '@beeve/ui'
import { Input, Button } from '@beeve/ui'

function BasicForm() {
  const form = createForm(() => ({
    defaultValues: {
      username: '',
      email: '',
    },
    onSubmit: async ({ value }) => {
      console.log('æäº¤æ•°æ®:', value)
    },
  }))

  return (
    <Form formApi={form} class="max-w-md space-y-4">
      <FormField name="username">
        {(field) => (
          <FormItem>
            <FormLabel>ç”¨æˆ·å</FormLabel>
            <FormControl>
              <Input
                value={field().state.value}
                onInput={(value) => field().handleChange(value)}
                onBlur={field().handleBlur}
                placeholder="è¯·è¾“å…¥ç”¨æˆ·å"
              />
            </FormControl>
            <FormDescription>è¿™æ˜¯æ‚¨çš„å…¬å¼€æ˜¾ç¤ºåç§°</FormDescription>
            <FormMessage />
          </FormItem>
        )}
      </FormField>

      <FormField name="email">
        {(field) => (
          <FormItem>
            <FormLabel required>é‚®ç®±</FormLabel>
            <FormControl>
              <Input
                type="email"
                value={field().state.value}
                onInput={(value) => field().handleChange(value)}
                onBlur={field().handleBlur}
                placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€"
              />
            </FormControl>
            <FormMessage />
          </FormItem>
        )}
      </FormField>

      <form.Subscribe
        selector={(state) => ({
          canSubmit: state.canSubmit,
          isSubmitting: state.isSubmitting,
        })}
      >
        {(state) => (
          <Button type="submit" disabled={!state().canSubmit}>
            {state().isSubmitting ? 'æäº¤ä¸­...' : 'æäº¤'}
          </Button>
        )}
      </form.Subscribe>
    </Form>
  )
}
```

</TabItem>
</Tabs>

## è¡¨å•éªŒè¯

### å­—æ®µçº§éªŒè¯

ä½¿ç”¨ `validators` å±æ€§åœ¨å­—æ®µçº§åˆ«æ·»åŠ éªŒè¯è§„åˆ™ï¼š

```tsx
<form.Field
  name="username"
  validators={{
    onChange: ({ value }) =>
      value.length < 3 ? 'ç”¨æˆ·åè‡³å°‘éœ€è¦ 3 ä¸ªå­—ç¬¦' : undefined,
    onBlur: ({ value }) =>
      !/^[a-zA-Z0-9]+$/.test(value) ? 'åªèƒ½åŒ…å«å­—æ¯å’Œæ•°å­—' : undefined,
  }}
>
  {(field) => (
    <FormItem>
      <FormLabel required>ç”¨æˆ·å</FormLabel>
      <FormControl>
        <Input
          value={field().state.value}
          onInput={(value) => field().handleChange(value)}
          onBlur={field().handleBlur}
          status={field().state.meta.errors.length > 0 ? 'error' : undefined}
        />
      </FormControl>
      <FormMessage />
    </FormItem>
  )}
</form.Field>
```

### Zod Schema éªŒè¯

TanStack Form åŸç”Ÿæ”¯æŒ Zod ç­‰ Standard Schema åº“ï¼š

```tsx
import { z } from 'zod'

<form.Field
  name="email"
  validators={{
    onChange: z.string().email('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'),
  }}
>
  {(field) => (
    <FormItem>
      <FormLabel required>é‚®ç®±</FormLabel>
      <FormControl>
        <Input
          type="email"
          value={field().state.value}
          onInput={(value) => field().handleChange(value)}
          status={field().state.meta.errors.length > 0 ? 'error' : undefined}
        />
      </FormControl>
      <FormMessage />
    </FormItem>
  )}
</form.Field>
```

### å¼‚æ­¥éªŒè¯

æ”¯æŒå¼‚æ­¥éªŒè¯ï¼Œä¾‹å¦‚æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨ï¼š

```tsx
<form.Field
  name="username"
  asyncDebounceMs={500}
  validators={{
    onChangeAsync: async ({ value }) => {
      const exists = await checkUsernameExists(value)
      return exists ? 'ç”¨æˆ·åå·²è¢«å ç”¨' : undefined
    },
  }}
>
  {(field) => (
    <FormItem>
      <FormLabel required>ç”¨æˆ·å</FormLabel>
      <FormControl>
        <Input
          value={field().state.value}
          onInput={(value) => field().handleChange(value)}
          suffix={field().state.meta.isValidating ? <Spinner /> : undefined}
        />
      </FormControl>
      <FormMessage />
    </FormItem>
  )}
</form.Field>
```

## å°ºå¯¸å˜ä½“

Form ç»„ä»¶æ”¯æŒä¸‰ç§å°ºå¯¸ï¼š`sm`ã€`md`ï¼ˆé»˜è®¤ï¼‰ã€`lg`ã€‚

```tsx
// ç´§å‡‘æ¨¡å¼ - é€‚ç”¨äºå¯†é›†å¸ƒå±€
<Form formApi={form} size="sm" class="space-y-3">
  {/* ... */}
</Form>

// æ ‡å‡†æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰
<Form formApi={form} size="md" class="space-y-4">
  {/* ... */}
</Form>

// å®½æ¾æ¨¡å¼ - é€‚ç”¨äºé‡è¦è¡¨å•
<Form formApi={form} size="lg" class="space-y-5">
  {/* ... */}
</Form>
```

## ç»„ä»¶ API

### Form

è¡¨å•å®¹å™¨ç»„ä»¶ï¼Œæä¾›è¡¨å•ä¸Šä¸‹æ–‡ã€‚

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `formApi` | `FormApi<any, any>` | - | TanStack Form API å®ä¾‹ï¼ˆå¿…å¡«ï¼‰ |
| `size` | `'sm' \| 'md' \| 'lg'` | `'md'` | è¡¨å•å°ºå¯¸ |
| `onSubmit` | `(e: SubmitEvent) => void` | - | è‡ªå®šä¹‰æäº¤å¤„ç†ï¼ˆå¯é€‰ï¼‰ |
| `class` | `string` | - | è‡ªå®šä¹‰ç±»å |

### FormField

å­—æ®µåŒ…è£…å™¨ï¼Œè¿æ¥ TanStack Form çš„ Field APIã€‚

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `name` | `string` | - | å­—æ®µåç§°ï¼ˆå¿…å¡«ï¼‰ |
| `children` | `(field: Accessor<FieldApi>) => JSX.Element` | - | æ¸²æŸ“å‡½æ•°ï¼ˆå¿…å¡«ï¼‰ |

### FormItem

å­—æ®µå®¹å™¨ï¼Œæä¾›ç»Ÿä¸€çš„é—´è·å’Œå¸ƒå±€ã€‚

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `children` | `JSX.Element` | - | å­å…ƒç´  |
| `class` | `string` | - | è‡ªå®šä¹‰ç±»å |

### FormLabel

å­—æ®µæ ‡ç­¾ï¼Œè‡ªåŠ¨å…³è”åˆ°è¾“å…¥æ¡†ã€‚

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `children` | `JSX.Element` | - | æ ‡ç­¾æ–‡æœ¬ |
| `required` | `boolean` | `false` | æ˜¯å¦æ˜¾ç¤ºå¿…å¡«æ ‡è®° |
| `class` | `string` | - | è‡ªå®šä¹‰ç±»å |

### FormControl

è¾“å…¥æ§ä»¶å®¹å™¨ã€‚

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `children` | `JSX.Element` | - | è¾“å…¥æ§ä»¶ |
| `class` | `string` | - | è‡ªå®šä¹‰ç±»å |

### FormDescription

å­—æ®µæè¿°æ–‡æœ¬ã€‚

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `children` | `JSX.Element` | - | æè¿°æ–‡æœ¬ |
| `class` | `string` | - | è‡ªå®šä¹‰ç±»å |

### FormMessage

é”™è¯¯æ¶ˆæ¯æ˜¾ç¤ºã€‚

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| `children` | `JSX.Element` | - | è‡ªå®šä¹‰é”™è¯¯æ¶ˆæ¯ï¼ˆè¦†ç›–å­—æ®µéªŒè¯é”™è¯¯ï¼‰ |
| `class` | `string` | - | è‡ªå®šä¹‰ç±»å |
| `forceMount` | `boolean` | `false` | å¼ºåˆ¶æ˜¾ç¤ºï¼ˆå³ä½¿æ²¡æœ‰é”™è¯¯ï¼‰ |

## æœ€ä½³å®è·µ

### 1. ä½¿ç”¨ Zod Schema è¿›è¡Œç±»å‹å®‰å…¨éªŒè¯

```tsx
import { z } from 'zod'

const userSchema = z.object({
  username: z.string().min(3, 'ç”¨æˆ·åè‡³å°‘ 3 ä¸ªå­—ç¬¦'),
  email: z.string().email('è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'),
  age: z.number().min(18, 'å¿…é¡»å¹´æ»¡ 18 å²'),
})

const form = createForm(() => ({
  defaultValues: {
    username: '',
    email: '',
    age: 0,
  },
  onSubmit: async ({ value }) => {
    // value ç±»å‹ä¼šè‡ªåŠ¨æ¨æ–­
    console.log(value)
  },
}))
```

### 2. ç»Ÿä¸€é”™è¯¯çŠ¶æ€æ ·å¼

å°†å­—æ®µé”™è¯¯çŠ¶æ€ä¼ é€’ç»™è¾“å…¥ç»„ä»¶ï¼š

```tsx
<Input
  value={field().state.value}
  onInput={(value) => field().handleChange(value)}
  status={field().state.meta.errors.length > 0 ? 'error' : undefined}
/>
```

### 3. ä½¿ç”¨ Subscribe æ§åˆ¶æäº¤æŒ‰é’®

```tsx
<form.Subscribe
  selector={(state) => ({
    canSubmit: state.canSubmit,
    isSubmitting: state.isSubmitting,
  })}
>
  {(state) => (
    <Button type="submit" disabled={!state().canSubmit}>
      {state().isSubmitting ? 'æäº¤ä¸­...' : 'æäº¤'}
    </Button>
  )}
</form.Subscribe>
```

## ç›¸å…³é“¾æ¥

- [TanStack Form å®˜æ–¹æ–‡æ¡£](https://tanstack.com/form/latest)
- [Zod æ–‡æ¡£](https://zod.dev/)
- [Input ç»„ä»¶](/components/input)
- [Button ç»„ä»¶](/components/button)


